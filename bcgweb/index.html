<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="OSS Repository">
    <meta name="author" content="OSS Repository">
    <link rel="icon" href="debpackage/images/favicon.ico" type="image/x-icon">

    <title>OSS Repository Portal</title>
    <!-- Bootstrap core CSS -->
    <link href="debpackage/assets/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- ChartJs CSS -->
    <!-- <link href="debpackage/assets/css/chartjs.css" rel="stylesheet">-->

    <!-- Custom styles for this template -->
    <link href="debpackage/assets/css/style.css" rel="stylesheet">
	<link href="debpackage/assets/css/faq.css" rel="stylesheet">
	<link href="https://cdn.datatables.net/1.10.9/css/jquery.dataTables.min.css" rel="stylesheet" />
	<link href="https://cdn.datatables.net/responsive/1.0.7/css/responsive.dataTables.min.css" rel="stylesheet" />
	<link href="debpackage/css/jquery-ui.css" rel="stylesheet" />
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	 <!-- Jquery Core Js -->
    <script src="https://cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/1.0.7/js/dataTables.responsive.min.js"></script>
	<style>
	
.panel-group .panel-heading + .panel-collapse > .panel-body {
  border: 1px solid #ddd;
}
.panel-group,
.panel-group .panel,
.panel-group .panel-heading,
.panel-group .panel-heading a,
.panel-group .panel-title,
.panel-group .panel-title a,
.panel-group .panel-body,
.panel-group .panel-group .panel-heading + .panel-collapse > .panel-body {
  border-radius: 2px;
  border: 0;
}
.panel-group .panel-heading {
  padding: 0;
}
.panel-group .panel-heading a {
  display: block;
  background: #f7a055;
  color: #ffffff;
  padding: 10px;
  text-decoration: none;
  position: relative;
}
.panel-group .panel-heading a.collapsed {
  background: #eeeeee;
  color: inherit;
}
.panel-group .panel-heading a:after {
  content: '-';
  position: absolute;
  right: 20px;
  top:5px;
  font-size:30px;
}
.panel-group .panel-heading a.collapsed:after {
  content: '+';
}
.panel-group .panel-collapse {
  margin-top: 5px !important;
}
.panel-group .panel-body {
  background: #fde3ce;
  padding: 15px;
}
.panel-group .panel {
  background-color: transparent;
}
.panel-group .panel-body p:last-child,
.panel-group .panel-body ul:last-child,
.panel-group .panel-body ol:last-child {
  margin-bottom: 0;
}

.panel-body div p{
	text-decoration: justify;
}
.panel-body .panel-group .panel-heading a.collapsed {
  background: #f9bb85;
  color: inherit;
}
.panel-body .panel-group .panel-body .panel-group .panel-heading a.collapsed {
  background: #fcd6b6;
  color: inherit;
}
.panel .panel-default:hover{box-shadow: 0px 0px 3px 0px #a6a6a6;}

	</style>
  </head>

  <body class="style-1">
    
  
  <!-- Top Bar -->

    <nav class="navbar navbar-expand-md navbar-light bg-navbar">
        <a href="index.php"  style="text-decoration:none;display:inline-block;"><h3 class="text-white unselectable" href="#"><img src="debpackage/assets/img/logo.png" alt="User" width="100px" height="30px"> Open Source Software Services</h3></a>
	</nav>
	

    <div class="container-fluid ">
     <div id="wrapper">
      
        

        

        <main role="main" class="col-md-12 ml-sm-auto col-lg-12 pt-3 pb-3">

         	
<div class="body">
<table id="ossisoimg" class="table table-bordered table-condensed text-center">
			<tbody>
			<tr ><th colspan="6" class="text-white p-1 bg-isoimg-1"><h3>Apache HTTPD Server 2.4.X Built from Source for CentOS 8.X </h3></th></tr>
			</tbody></table>
	<form>
	
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
             
             
      

        
<!-- nested accordion starts -->

	

<!-- nested accordion ends -->	
<br/>


<div class="panel-group" id="nested">
	<div class="panel panel-default">
	   <div class="panel-heading">
		  <h6 class="panel-title">
			 <a class="ques collapsed" data-toggle="collapse" data-parent="#nested" href="#phpupd">
			 1. Release Notes
			 </a>
		  </h6>
	   </div><!--/.panel-heading -->
	   <div id="phpupd" class="panel-collapse collapse in">
		  <div class="panel-body">
			<pre>
###########################################################################
#
#  RPM for Apache Web Server (http server)  2.4.X compiled
#  from the source code
#
###########################################################################
</pre>
DISTRIBUTION<br/>

This distribution is for the exclusively use of e-Governance Projects deployed in NIC Cloud/ Open Stack only. This contains Apache Web Server (http server)  2.4.41 compiled from the source code.<br/>

This deb works well with CentOS 8 <br/>

This deb will install Apache Web Server (http server) 2.4.41 and  depends on the following deb package.

libxml2-dev<br/>
libprcre++-dev<br/>
openssl-nic<br/>
nghttp2-nic<br/>

The package httpd-nic_2.4.41_amd64.deb can be obtained from the following 
	NIC Repo Server:<br/>
	<pre>< TO BE ANNOUNCED></pre><br/>
	OSS Repository Portal:<br/>
	<a href="https://ossrepository.gov.in" target="_blank">https://ossrepository.gov.in </a><br/>
Login in to https://digital.nic.in --> Online Services --> OSS Repository --> Repository --> ROPM Packages<br/>

All custom deb packages (packages ending with -nic ) prepared for NIC Cloud can be downloaded from this location.
<br/>
<br/>

IMPORTANT INSTRUCTION<br/>

The DocumentRoot configured  and provided with this package is for use of functionality  and vulnerability assessment testing only. For production, change DocumentRoot to a location preferably at SAN Space/Partition.
<br/><br/>
BEST PRACTICES / STANDARD OPERATING PROCEDURE<br/>

The Best Practices /SOP  document(s) can be downloaded from https://ossrepository.gov.in from where the RPM is distributed. It is essential to go through these documents.
<br/><br/>
ASSISTANCE<br/>

You can seek assistance through NIC service desk (https://servicedesk.nic.in.) under OTG – OSS Service  -->>  Web / HTTP Server -->> Apache HTTP Server

Support Requests through IP phone with out registering at NIC Service Desk will not be entertained.
		  </div><!--/.panel-body -->
	   </div><!--/.panel-collapse --> 
	</div><!-- /.panel --> 
</div>				
				
<div class="panel-group" id="nested2">
	<div class="panel panel-default">
	   <div class="panel-heading">
		  <h6 class="panel-title">
			 <a class="ques collapsed" data-toggle="collapse" data-parent="#nested2" href="#postgresupd">
			 2. README
			 </a>
		  </h6>
	   </div><!--/.panel-heading -->
	   <div id="postgresupd" class="panel-collapse collapse">
		  <div class="panel-body">
	<pre>		
###########################################################################
#
#
#  RPM for Apache Web Server (http server)  2.4.X compiled 
#  from the source code
#  
#  National Informatics Centre
#  Government of India
#  January 2020
#  OTG-OSSR-RM-2020-005
############################################################################

DISTRIBUTION

This distribution is for the exclusively use of e-Governance Projects deployed in NIC Cloud/ Open Stack only. This contains Apache Web Server (http server) 2.4.41 compiled from the source code. 

This deb works well with CentOS 8.X

This deb will install Apache Web Server (http server) 2.4.41 and  depends on the following deb package.

libxml2-dev
libprcre++-dev
openssl-nic
nghttp2-nic

IMPORTANT INSTRUCTION

The DocumentRoot configured  and provided with this package is for use of functionality testing and vulnerability assessment testing only. For production, change
 DocumentRoot to a location preferably at SAN Space/Partition..

BEST PRACTICES / STANDARD OPERATING PROCEDURE

The Best Practices /SOP  document(s) can be downloaded from https://ossrepository.gov.in.

ASSISTANCE

You can seek assistance through NIC service desk (https://servicedesk.nic.in.) under 
OTG – OSS Service  -->> Web / HTTP Server -->> Apache HTTP Server

Support Requests through IP phone with out registering at NIC Service Desk will not be entertained.

INSTALLATION

********************************************************************************
Before executing the following, remember to take back of existing configuration 
files of Apache Web Server, htdocs folder and application if any. 
********************************************************************************

Method-1:
Download the files apache-nic_2.4.41_amd64.deb and nghttp2-nic_amd64.deb 
from the https://ossrepository.gov.in. 
Run the commands as root  "dpkg -i nghttp2-nic_amd64.deb" and "dpkg -i apache-nic_2.4.41_amd64.deb"
This will install nghtt2 and apache 2.4.41 in folder (/usr/local/pgsql) and start the service apache2 service by default.

Method-2:
This can also be installed using NIC CentOS repository also.

< Procedure wil lbe shared after Repository Setup>

POST INSTALLATION

1. After the installation check whether server is running or not.

   # ps -ef |grep httpd

root      4981  2458  0 11:08 ?        00:00:00 /usr/local/apache24/bin/httpd -k start
daemon    4982  4981  0 11:08 ?        00:00:00 /usr/local/apache24/bin/httpd -k start
daemon    4983  4981  0 11:08 ?        00:00:00 /usr/local/apache24/bin/httpd -k start
daemon    4984  4981  0 11:08 ?        00:00:00 /usr/local/apache24/bin/httpd -k start
root      5254  4769  0 11:09 pts/1    00:00:00 grep --color=auto httpd



2. If Apache server is not running, use the command "/etc/init.d/apache2 start" or "systemctl start apache2"

3. Access the Server

    Open Browser and access http://localhost
    
4. By default, the installation includes pre-initialized DocumentRoot  which can be used for testing purposes. Users will initialize the production DocumentRoot in a
 SAN partition or out side of the postgres installation.

STARTING and STOPPING the Server

    Login as root at the os level
    # systemctl stop apache24
    # systemctl start apache24

SECURITY

OS LEVEL: While Connecting the DB Server from App Server/Client, at OS Level in /etc/selinux/config file is  set #vi /etc/selinux/config
SELINUX=permissive

Apache LEVEL: 
	1. Enable Postgres to listen on host IP address in file  /var/lib/pgsql/data/12/postgresql.conf
listen_addresses = 'ip address of host'
2. Enable Application Server to connect to positgresql host  in file /var/lib/pgsql/data/12/pg_hba.conf

	host    all             all             <ipaddressofAPPServer>/netmask            passwd

OPTIMISATION

1. Resource Limit:

2. Connections: 

3. Tuning:


After optimisation the Server needs to be Restarted

MIGRATION

The migration should be done when website should be down. Depending on the size of the database and speed of network sufficient downtime may be intimated to all
 those concerned before commencing the migration activity. It is suggested that Migration to higher version is carried out.

Migrating the application particularly with Java, the team has to ensure that  correct JDBC driver jar corresponding to their Java/JRE version as mentioned in
https://jdbc.postgresql.org download section. It is better check the application with latest version in the staging/demo server, before attempting to implement on
 production server.

For Apache with PHP, the application team has to ensure that PHP is compiled with  flags --with-pgsql and --with-pdo-pgsql  for postgresql 12 server/client libraries are.


IMPORTING DocumentRoot FROM PREVIOUS Apache Server 
</pre>
		  </div><!--/.panel-body -->
	   </div><!--/.panel-collapse --> 
	</div><!-- /.panel --> 
</div>		
<div class="panel-group" id="nested3">
	<div class="panel panel-default">
	   <div class="panel-heading">
		  <h6 class="panel-title">
			 <a class="ques collapsed" data-toggle="collapse" data-parent="#nested3" href="#apacheupd">
			 3. Standard Operating Procedure (SOP)
			 </a>
		  </h6>
	   </div><!--/.panel-heading -->
	   <div id="apacheupd" class="panel-collapse collapse">
		  <div class="panel-body">
			<table class="table table-hover table-bordered" style="width:100%;">
				<tbody>
				
				<tr><td>The SOP provides information on how to configure, secure , operate and seek assistance. <a href="debpackage/assets/pdf/SOP-httpd-nic_2.4.41.pdf" target="_blank">Open</a></td>
				<tr><td>Document can be downloaded by logging into <a href="https://ossrepository.gov.in" target="_blank">https://ossrepository.gov.in.</a><br/>
				After login select Repository -> RPM Packages - > Select the appropriate RPM Package -> Documents -> SOP. </td></tr>
				</tr>
				</tbody>
				</table>
		  </div><!--/.panel-body -->
	   </div><!--/.panel-collapse --> 
	</div><!-- /.panel --> 
</div>					
				
				
				<br/>
				
		 </div>

		<br/>
<!-- minor version modal starts -->
			<div class="modal fade" id="md5Modal">
				<div class="modal-dialog modal-lg">
				  <div class="modal-content" style="height: 300%;background-color:#ffffff;">
				  
					<!-- Modal Header -->
					<div class="modal-header">
					  <h6 class="modal-title" style="color: DodgerBlue;" id="md5title"></h6>
					  <button type="button" class="closemodal" data-dismiss="modal" aria-label="Close">&times;</button>
					</div>
					
					<!-- Modal body -->
					<div class="modal-body" id="md5content"  style="background-color: #e6ffcc;">
					 	  
					 </div>
					
					<!-- Modal footer -->
					<div class="modal-footer" id="md5contentfooter" style="float:right;">
					  <!--<button type="button" class="closemodal" data-dismiss="modal" aria-label="Close">&times;</button>-->
					  <!--<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>-->
					  <!--<button id="CloseModalbtn" type="button" class="btn btn-danger">Close</button>-->
					</div>
					
				  </div>
				</div>
			</div>
			<!-- minor version modal ends -->	



	
	</form>
	<div id='somediv'></div>
	
</div>
	  <br/>
		
		
	  
		
	  </div>
			  
        </main>
      </div>
    </div>
<br/>
<br/>
<div id="downloading-file" class="modal fade" role="dialog">
  <div class="modal-dialog  modal-lg">
      
  
   <div class="modal-content">
   <!-- Modal Header -->
	<div class="modal-header btn-info text-center" style="color:#2B4A9F;background-color: #85e5f8;display: block; font-weight:bold;font-size:100%;">
	  Preparing for download please wait...
	  <button type="button" class="close" data-dismiss="modal" aria-hidden="true" aria-label="Close">&times;</button>
	</div>
				
      <!--<div class="modal-header btn-info">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Preparing for download please wait...</h4>
      </div>-->
      <div class="modal-body">     	
     <div class="progress">
     <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:1%">
    </div><br/>
    </div>
    <div id="information" style="display:block;"></div>
    </div>
    </div>
      
    </div>

  </div>

<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
<div class="container-fluid ">
	<div id="wrapper">
		<div class="text-center text-white bg-info">
		<strong style="text-decoration:underline;">DISCLAIMER</strong>

		<p>Though all efforts have been made to ensure the accuracy and currency of the content in this Package,the same should not be construed as a statement of law or used for any legal purposes. In no event will the Government or NIC be liable for any expense, loss or damage including, without limitation, indirect or consequential loss or damage, or any expense, loss or damage whatsoever arising from use, or loss of use, of data, arising out of or in connection with the use of this Package. </p>
		</div>
	</div>
</div>
<br/>
<footer class="footer full-width bg-blackblue" >
	
      <div class="text-center">
		<span class="text-white">© National Informatics Centre.</span><br/>
      </div>
	</footer>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="debpackage/assets/js/jquery-3.3.1.js"></script>
    <script src="debpackage/assets/js/bootstrap.min.js"></script>
    <script src="debpackage/assets/js/chartjs.js"></script>
	<script src="js/jmespath.min.js"></script>
    <script src="js/jquery-ui.js"></script>
	<script  src="debpackage/assets/js/jq-ajax-progress.min.js"></script> 
	<script src="debpackage/assets/js/ossfunctionality.js"></script>
	
    <script>


$(document).ready(function(){
	loadmenuitems();
	$("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
		$("#sm-sidebar-wrapper").addClass("sm-toggled");
    });

	
	$("#CloseModalbtn").click(function(){
		alert("closemodal btn");
		//$("#minorVersionsModal").modal('dispose'); 
		$("#md5Modal").modal('hide'); 
	});
	
});

function openmodal(obj)
	{
       /* var x = document.getElementById("md5Modal");
        x.open = true;*/
        var path =  $(obj).attr('a_href');
        $(obj).attr("href",path);
		$("#md5title").empty();
		$("#md5content").empty();
		$("#md5contentfooter").empty();
		$("#md5title").html("Md5/SHA512sum for - "+obj.title);

		$("#md5content").html('<object width="100%" height="100%" type="text/html" data='+obj.href+' ></object>');
		var $btnappnd = $('<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>');
		$btnappnd.appendTo($('#md5contentfooter'));
		
		$("#md5Modal").modal('show'); 
		$(obj).removeAttr("href");
        $(obj).attr("href","javascript:void(0);");	
	}




function readableBytes(bytes) {

		    var i = Math.floor(Math.log(bytes) / Math.log(1024)),
		    sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];

		    return (bytes / Math.pow(1024, i)).toFixed(2) * 1 + ' ' + sizes[i];
		}



function downloadProgress(e) {

		  if (e.lengthComputable) {

		      var percentage = parseInt((e.loaded * 100) / e.total);
 				//console.log(percentage);

		  $('#downloading-file .progress .progress-bar').css("width", percentage+"%");

          $("#information").show();
          //alert(parseInt(percentage));

          var fsize = readableBytes(e.total);

		  $("#information").html("<div style=\"text-align:center; font-weight:bold;\"> "+percentage+"% is processed and filesize is "+fsize+" </div>");	

		    }
		
}





$(".download_file").click(function(){
	  var r = confirm('Would you like to download <?php echo $kstart['ksName']  ?> ?' );
  //if (r == true) {
        //var access_key = sessionStorage.getItem('access_token');
/*alert(access_key);*/
        var isoFileName='';

	    var user_id = "<?php echo $_SESSION['user']; ?>";
//alert(user_id);	
        var user_role = "<?php echo $_SESSION['roleid']; ?>";
//alert(user_role);	

        var tool_id = $(this).attr('ks_id');
//alert(tool_id);	
        var file_type = $(this).attr('file_type');


		var kickStartCollectionarr="";
		var subCategoriesarr="";
		var kickStarts="";
		        

        //var base_app_url = 'http://10.163.14.76:8082/toollister/';
var base_app_url = 'http://10.163.14.80:808/toollister/';
        //var base_app_url = 'https://ossrepository.gov.in/toollister/';


        //var access_key='';
        var file_url='';

		/*$.ajax({


				url:'tokenverification/settoken.php',
				//url:'../toollister/settoken.php',
				type: 'POST',
				//data: access_key,
				dataType: "JSON",

				success: function(data) {
					
        console.log(data.access_token);
                         access_key = data.access_token;		
                      
				}
		});
*/

     

        $.ajax({
			url: "kickstart_json/kickstart-meta-data-2019-10-16.json",
			async: false,
			//data: access_key,
			dataType: "json",
			success: function(data) {
				
		
		//alert(data.kickStartCollection[0].subCategories[0].kickStarts[0].isoFileName);
		        //var subCategory_arr =data.kickStartCollection[0].subCategories;
		        kickStartCollectionarr =data.kickStartCollection;
		        for(a=0; a < kickStartCollectionarr.length; a++) {
		        	subCategoriesarr=kickStartCollectionarr[a].subCategories;
		        	for(b=0; b < subCategoriesarr.length; b++) {

						kickstartsarr=subCategoriesarr[b].kickStarts;

                        for(c=0; c < kickstartsarr.length; c++) {

			//alert(kickstartsarr[c].ksId);	


						if(tool_id==kickstartsarr[c].ksId){


							var ksisoFileName =kickstartsarr[c].isoFileName;

							var ksisoPdffileName =kickstartsarr[c].docs[0].fileName;

							//alert(ksisoPdffileName);
							
							if(file_type=='1'){

		                      file_url = ksisoFileName;
		                      var file_name_arr = ksisoFileName.split('/');
		                      
                              file_name = file_name_arr[file_name_arr.length-1];


		                   }else if(file_type=='2'){

		                   	  file_url = ksisoPdffileName;
		                   	  var file_name_arr = ksisoPdffileName.split('/');
		                      
                              file_name = file_name_arr[file_name_arr.length-1];
		                   }


                        $.ajax({
	    	
               
                     					//url: 'tokenverification/download-file-kickstart.php',

                     					url: '../toollister/download-file-kickstart.php',


                            			//headers: {'Authorization': access_key},

                            			/*headers: {'Authorization': 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJuYW1lIjozODAwLCJpc3MiOiJodHRwczpcL1wvb3NzcmVwb3NpdG9yeS5nb3YuaW4iLCJhdWQiOiJodHRwczpcL1wvb3NzcmVwb3NpdG9yeS5nb3YuaW4iLCJpYXQiOjE1NzMxMjg0OTksImV4cCI6MTU3MzEzMDI5OSwiZW1haWwiOiJycmFtZXNoQG5pYy5pbiJ9.jKOFyQbhsVIMJ2pItWBVcIRudw4XHK5QCwuizRY3BMY'},*/

                                        type: 'POST',
                                         data: {'src':btoa(file_url),'src2':btoa(base_app_url),'file_type':file_type,'tool_id':tool_id,'url':base_app_url+file_url},
                                                xhrFields: {
                                                          responseType: 'blob'
                                               },
                                              
                                               progress: downloadProgress,

											   beforeSend:function(){
											   	if(file_type=='1'){
								 				$('#downloading-file').modal('show');
								     			}else if(file_type =='2'){
                                                $('#downloading-file').modal('hide');
								     			  }
								     			},  
								     			

                                        success: function (data) {

                       //  console.log(data);                
                                                   var a = document.createElement('a');
                                                   var url = window.URL.createObjectURL(data);
                                                   a.href = url;
                                                   a.download = file_name;
                                                   document.body.append(a);
                                                   a.click();
                                                   a.remove();
                                                   window.URL.revokeObjectURL(url);
                                                   $('#downloading-file').modal('hide');
                                                 },

                                        error: function (xhr,status,error) {

                                        
											if(xhr.status==401){

												$('#downloading-file').modal('hide');
												alert("Authorization error occured while downloading!...");
												
											}
											else if(xhr.status==500){

												$('#downloading-file').modal('hide');
												alert("Internal Server error occured while downloading!...");
												
											}
											else{
												
												$('#downloading-file').modal('hide');
												alert("Error occurred while downloading a file!!");
												
											}

							            }
						});



		            }
		        }
		        }
           }

        }
    });     
   
  }
  else{
	  
  }
    

	  					 
});

</script>
<style>


/*tr:nth-child(even) { background-color: #f2f2f2; }*/

th {
	background-color: #F0F0F0;
	color: #808080;
}
/*
td {
	overflow-wrap: break-word;
}
*/
.card-header {
	padding: 1.75rem 1.25rem !important;
}

.modal-dialog {
          width: 100%;
          height:40% !important;
        }




</style>
  </body>
</html>
